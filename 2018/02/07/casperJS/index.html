<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> casperJS · lie on this ip ，I am lin</title><meta name="description" content="A Blog Powered By Hexo"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/jekyll.css"><!--[if lt IE 9]>
<script src="js/html5shiv.min.js"></script>
<script src="js/respond.min.js"></script>
<![endif]--></head><body><header class="row-flex-row limit-width vh-center"><a href="/" class="logo"><img src="/dog.png"></a><nav><ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-link">Home</a></li><li class="nav-list-item"><a href="/archives/" class="nav-link active">   Blog</a></li><li class="nav-list-item"><a href="https://github.com/xxxxxx111" target="_blank" class="nav-link">github</a></li><li class="nav-list-item"><a href="https://coding.net/u/xxxxxx" target="_blank" class="nav-link">coding</a></li><li class="nav-list-item"><a href="http://weibo.com/xxxxxx" target="_blank" class="nav-link">weibo</a></li><li class="nav-list-item"><a href="/atom.xml" class="nav-link">rss</a></li></ul></nav></header><div class="container limit-width"><section class="row-flex-row"><div class="post"><article class="post-block"><h2 class="post-title"><a href="/2018/02/07/casperJS/" class="post-title-link">casperJS</a></h2><div class="post-meta"><ul class="post-tag-list"><li class="post-tag-item"><a href="/tags/js/" class="post-tag-link">js</a></li></ul><div class="post-time">Wednesday, February 7th 2018</div></div><div class="post-content"><h2 id="linux安装"><a href="#linux安装" class="headerlink" title="linux安装"></a>linux安装</h2><p>1安装 phantomjs 环境</p>
<p><code>$ npm install -g phantomjs</code></p>
<p>2 接下来，我们安装 CasperJS：</p>
<p><code>$ npm install -g casperjs</code></p>
<p>3 安装 CasperJS 必须确保在 Python 环境下，Python下载之后直接安装即可。</p>
<p>确认环境是否安装成功：</p>
<p><code>$ phantomjs --version
$ python --version
$ casperjs --version</code></p>
<h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h2><p>新建一个<code>sample.js</code>,这里访问的两个网页，可能速度比较慢，没有vpn的话</p>
<p>！！！！这里是页面测试！！！！</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> casper = <span class="built_in">require</span>(<span class="string">'casper'</span>).create(); <span class="comment">//新建一个页面</span></span><br><span class="line"></span><br><span class="line">casper.start(<span class="string">'http://casperjs.org/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.echo(<span class="keyword">this</span>.getTitle());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">casper.thenOpen(<span class="string">'http://phantomjs.org'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.echo(<span class="keyword">this</span>.getTitle());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">casper.run();</span><br></pre></td></tr></table></figure>
<p>用python跑这段代码</p>
<p><code>$ casperjs sample.js</code>  你会看到结果～</p>
<p>！！！！这里是脚本测试！！！！</p>
<p>我们新建一个<code>test-hello.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">casper.test.begin(<span class="string">"Hello, Test!"</span>, <span class="number">1</span>, <span class="function"><span class="keyword">function</span>(<span class="params">test</span>) </span>&#123;</span><br><span class="line">  test.assert(<span class="literal">true</span>);</span><br><span class="line">  test.done();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// hello Test 是描述信息</span></span><br><span class="line"><span class="comment">// 1 代表有几个断言</span></span><br></pre></td></tr></table></figure>
<p>跑这段代码</p>
<p><code>casperjs test hello-test.js</code></p>
<h2 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h2><p>假如有如下代码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>My page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"page-title"</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>one<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>two<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>three<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">footer</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>©2012 myself<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>要检查示例页面中是否存在<code>&lt;h1 class =“page-title”\&gt;</code>元素，可以使用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> casper = <span class="built_in">require</span>(<span class="string">'casper'</span>).create(); <span class="comment">//新建一个页面,一个无界面浏览器</span></span><br><span class="line"><span class="comment">//访问你的文件地址  本地：http://localhost/demo.html</span></span><br><span class="line">casper.start(<span class="string">'http://domain.tld/page.html'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">//这里没有用测试框架，时自己判断有什么，输出什么</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.exists(<span class="string">'h1.page-title'</span>)) &#123;</span><br><span class="line">        <span class="keyword">this</span>.echo(<span class="string">'the heading exists'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">casper.run();</span><br></pre></td></tr></table></figure>
<p>用测试框架<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">casper.test.begin(<span class="string">'The heading exists'</span>, <span class="number">1</span>, <span class="function"><span class="keyword">function</span> <span class="title">suite</span>(<span class="params">test</span>) </span>&#123;</span><br><span class="line">    casper.start(<span class="string">'http://domain.tld/page.html'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        test.assertExists(<span class="string">'h1.page-title'</span>);</span><br><span class="line">    &#125;).run(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        test.done();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">casper.test.begin(<span class="string">'Page content tests'</span>, <span class="number">3</span>, <span class="function"><span class="keyword">function</span> <span class="title">suite</span>(<span class="params">test</span>) </span>&#123;</span><br><span class="line">    casper.start(<span class="string">'http://domain.tld/page.html'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        test.assertExists(<span class="string">'h1.page-title'</span>);</span><br><span class="line">        test.assertSelectorHasText(<span class="string">'h1.page-title'</span>, <span class="string">'Hello'</span>);</span><br><span class="line">        test.assertVisible(<span class="string">'footer'</span>);</span><br><span class="line">    &#125;).run(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        test.done();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>单元测试</p>
<p>新建文件 <code>cow-test.js</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Cow</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.mowed = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">this</span>.moo = <span class="function"><span class="keyword">function</span> <span class="title">moo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.mowed = <span class="literal">true</span>; <span class="comment">// mootable state: don't do that at home</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'moo!'</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//这里用了它的测试框架</span></span><br><span class="line">casper.test.begin(<span class="string">'Cow can moo'</span>, <span class="number">2</span>, <span class="function"><span class="keyword">function</span> <span class="title">suite</span>(<span class="params">test</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cow = <span class="keyword">new</span> Cow();</span><br><span class="line">    test.assertEquals(cow.moo(), <span class="string">'moo!'</span>); <span class="comment">//这里就是判断执行函数的结果是否和后边的一致</span></span><br><span class="line">    test.assert(cow.mowed);</span><br><span class="line">    test.done();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>运行 <code>$ casperjs test cow-test.js</code> 进行测试</p>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><div class="note"><br><h5>casper module</h5><br><p>casper 模块</p><br></div>

<h3 id="casper-class"><a href="#casper-class" class="headerlink" title="casper class"></a>casper class</h3><p>最简单获得一个capser实例</p>
<p><code>var casper = require(&#39;casper&#39;).create();</code></p>
<h3 id="casper-options"><a href="#casper-options" class="headerlink" title="casper options"></a>casper options</h3><p>一些选项可以传递给构造函数</p>
<p>有两种方式</p>
<p>第一种：实例化时传入</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> casper = <span class="built_in">require</span>(<span class="string">'casper'</span>).create(&#123;</span><br><span class="line">    clientScripts:  [</span><br><span class="line">        <span class="string">'includes/jquery.js'</span>,      <span class="comment">// These two scripts will be injected in remote</span></span><br><span class="line">        <span class="string">'includes/underscore.js'</span>   <span class="comment">// DOM on every request</span></span><br><span class="line">    ],</span><br><span class="line">    pageSettings: &#123;</span><br><span class="line">        loadImages:  <span class="literal">false</span>,        <span class="comment">// The WebPage instance used by Casper will</span></span><br><span class="line">        loadPlugins: <span class="literal">false</span>         <span class="comment">// use these settings</span></span><br><span class="line">    &#125;,</span><br><span class="line">    logLevel: <span class="string">"info"</span>,              <span class="comment">// Only "info" level messages will be logged</span></span><br><span class="line">    verbose: <span class="literal">true</span>                  <span class="comment">// log messages will be printed out to the console</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>第二种：运行时加入</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> casper = <span class="built_in">require</span>(<span class="string">'casper'</span>).create();</span><br><span class="line">casper.options.waitTimeout = <span class="number">1000</span>;</span><br></pre></td></tr></table></figure>
<p>下边介绍所有的选项</p>
<p>clientScripts：数组类型，默认为[],里面包含在每个加载的页面中的脚本文件路径的集合。</p>
<p>exitOnError： 布尔类型 默认true ，设置CasperJS在脚本抛出未捕获错误时必须退出。</p>
<p>httpStatusHandlers： 对象类型 默认{} 当请求资源为给定状态码时，调用对象内的函数</p>
<p>logLevel：字符串类型 默认“error”</p>
<p>onAlert：函数类型 默认为null 当alert()被调起时，执行的函数</p>
<p>onDie：函数类型 默认为null  当发生错误时，调起的函数</p>
<p>onLoadError：函数类型 默认为null  无法加载请求的资源时调用的函数</p>
<p>onPageInitialized：函数类型 默认为null     WebPage实例初始化后调用的函数</p>
<p>onResourceReceived：函数类型 默认为 null   PhantomJS的WebPage＃onResourceReceived（）回调的代理方法，但当前的Casper实例作为第一个参数传递。</p>
<p>onResourceRequested：函数类型  默认为null  PhantomJS的WebPage＃onResourceRequested（）回调的代理方法，但当前的Casper实例作为第一个参数传递。</p>
<p>onStepComplete：函数类型  默认为null  步功能执行结束时执行的功能。</p>
<p>onStepTimeout：函数类型 默认为function   当step功能执行时间超过stepTimeout选项的值（如果有的话）被设置时执行的功能。<br>默认情况下，在超时时，脚本将会退出，显示一个错误，除了在测试环境中，它只会向套件结果添加一个失败。</p>
<p>onTimeout： 函数类型  默认为function    当脚本执行时间超过超时选项的值（如果已设置）时要执行的功能。<br>默认情况下，在超时时，脚本将会退出，显示一个错误，除了在测试环境中，它只会向套件结果添加一个失败。</p>
<p>onWaitTimeout：函数类型 默认为function    当waitFor * 函数执行时间超过waitTimeout选项的值（如果已设置）时执行的函数。<br>默认情况下，在超时时，脚本将会退出，显示一个错误，除了在测试环境中，它只会向套件结果添加一个失败。</p>
<p>page： webpage类型 默认为null  </p>
<p>pageSettings： 对象类型 默认为{}</p>
<p>remoteScripts：数组类型 默认[]， 包含在每个加载的页面中的远程脚本URL的集合</p>
<p>stepTimeout： number类型 默认为null    以毫秒为单位的最大步长超时; 当设置时，每个定义的步进函数都必须在达到该超时值之前执行。 您可以定义onStepTimeout（）回调来捕获这种情况。 默认情况下，脚本将死（）与一个错误消息。</p>
<p>timeout：number类型  默认值为null   以毫秒为单位的最大超时时间</p>
<p>verbose： 布尔类型  默认false  实时输出日志消息</p>
<p>viewportSize： 对象类型 默认为null  Viewport size, eg. {width: 800, height: 600}</p>
<p>retryTimeout：number类型 默认100   两次尝试之间的默认延迟，用于等待 功能。</p>
<p>waitTimeout：Number类型 默认5000 默认等待时间</p>
<h2 id="Casper-peototype"><a href="#Casper-peototype" class="headerlink" title="Casper peototype"></a>Casper peototype</h2><p>back() 在浏览器历史中后退</p>
<p>base64encode()  使用客户端XMLHttpRequest同步使用base64算法对资源进行编码。您也可以执行HTTP POST请求来检索要编码的内容</p>
<p>bypass() 绕过给定数量的定义的导航步骤</p>
<p>click()  单击与提供表达式相匹配的与元素。可以使用javascript鼠标事件，如果不可以，那么使用本机事件</p>
<p>clickLabel() 点击第一个包含该文本的元素</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;a href="..."&gt;My link is beautiful&lt;/a&gt;</span></span><br><span class="line">casper.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.clickLabel(<span class="string">'My link is beautiful'</span>, <span class="string">'a'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>capture()   网页截图</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> casper = <span class="built_in">require</span>(<span class="string">'casper'</span>).create();</span><br><span class="line"><span class="comment">//如果不给出&#123;&#125;里的参数，默认截取整个网页，这个可以解决不能截取整个超级大网页的问题～～～</span></span><br><span class="line">casper.start(<span class="string">'http://localhost'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.capture(<span class="string">'1.png'</span>,&#123;<span class="comment">//注意截取.png   jpg 会截取不到透明部分</span></span><br><span class="line">    top: <span class="number">100</span>,  <span class="comment">//截取位置</span></span><br><span class="line">    left: <span class="number">100</span>,</span><br><span class="line">    width: <span class="number">500</span>,<span class="comment">//截取大小</span></span><br><span class="line">    height: <span class="number">400</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">casper.run();</span><br></pre></td></tr></table></figure>
<p>captureBase64() 将捕获的图片转换成base64</p>
<p>captureSelector()   捕获某个选择器里面的图片</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">casper.start(<span class="string">'http://www.weather.com/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.captureSelector(<span class="string">'weather.png'</span>, <span class="string">'#LookingAhead'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">casper.run();</span><br></pre></td></tr></table></figure>
<p>clear() 清空当前执行环境上下文。避免以前加载的DOM仍然有效</p>
<p>clearCache()  用newPage（）替换当前页面，用clearMemoryCache（）清除内存缓存。</p>
<p>clearMemoryCache()  使用引擎page.clearMemoryCache（）清除内存缓存。</p>
<p>debugHTML()</p>
<p>die()  用记录的错误消息和可选的退出状态码</p>
<p>download()   将远程资源保存到文件系统中。</p>
<p>each()  遍历提供的数组项并执行回调</p>
<p>eachThen() 迭代所提供的数组项，并添加一个步骤到当前数据附加到堆栈</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> casper = <span class="built_in">require</span>(<span class="string">'casper'</span>).create();</span><br><span class="line"><span class="keyword">var</span> urls = [<span class="string">'http://google.com/'</span>, <span class="string">'http://yahoo.com/'</span>];</span><br><span class="line"></span><br><span class="line">casper.start().eachThen(urls, <span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.thenOpen(response.data, <span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Opened'</span>, response.url);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">casper.run();</span><br></pre></td></tr></table></figure>
<p>echo()  将某些东西打印到标准输出，可选择一些奇特的颜色（有关更多信息，请参阅颜色模块）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">casper.start(<span class="string">'http://www.google.fr/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.echo(<span class="string">'Page title is: '</span> + <span class="keyword">this</span>.evaluate(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">document</span>.title;</span><br><span class="line">    &#125;), <span class="string">'INFO'</span>); <span class="comment">// Will be printed in green on the console</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">casper.run();</span><br></pre></td></tr></table></figure>
<p>evaluate()  评估当前DOM表达式。evaluate()是在casperjs环境和你所打开的网页的桥梁，也就是你使用evaluate()是在操作你当前打开的DOM文档，是casperjs环境和DOM文档的一个交互，这就像你是在用浏览器的控制台控制html内容是一样一样的。</p>
<p>evaluateOrDie()  返回true时，计算表达式，否则，die</p>
</div></article><div class="pagination"><a href="/2018/03/13/Tip/" class="pagination-prev">PREV</a><a href="/2018/02/06/canvas5/" class="pagination-next">NEXT</a></div><div class="comments"></div></div><aside class="sidebar"><h3>分类标签</h3><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/H5/">H5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aliNginx/">aliNginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/interview/">interview</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/拓展/">拓展</a></li></ul><h3>最新文章</h3><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/08/22/Es5Basis-2/">Es5Basis-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/15/Es5Basis-1/">Es5Basis-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/07/jsMechanism/">jsMechanism</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/07/aliNginx/">aliNginx</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/25/Interview/">Interview</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/20/vueapi/">VueAPI</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/18/javascriptChartingLib/">JavaScript 图表库</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/15/vue/">vue 教程 computed watcher class style v-for v-if 事件 表单 组件 指令</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/15/js-cssLib/">js/cssLib</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/14/git/">Git 常用命令</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/13/Tip/">cssTip</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/07/casperJS/">casperJS</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/06/canvas5/">canvas基础（五）基本动画</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/06/canvas4/">canvas基础（四）状态</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/06/canvas3/">canvas基础（三） 使用图片</a></li></ul></aside></section></div><div class="extra"></div><footer class="footer"><div class="row-flex-row limit-width vh-center"><div class="copyright"><P>Powered by lin © 2018 <a href="/">lin</P></div></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-80781234-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "//hm.baidu.com/hm.js?ee75cf111111aa99f8540efa2570970";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>